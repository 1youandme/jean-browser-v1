{'role': 'assistant', 'content': '\n<function_calls>\n<create-file file_path="src/hooks/useJeanAI.ts">\nimport { useState, useCallback, useEffect } from \'react\';\nimport { JeanMessage, JeanAction, AIRequest, AIResponse, Tab } from \'../types\';\n\ninterface UseJeanAIProps {\n  backendUrl?: string;\n}\n\nexport const useJeanAI = ({ backendUrl = \'http://localhost:8080\' }: UseJeanAIProps = {}) => {\n  const [conversation, setConversation] = useState<JeanMessage[]>([]);\n  const [isTyping, setIsTyping] = useState(false);\n  const [activeTab, setActiveTab] = useState<Tab | null>(null);\n\n  const generateMessageId = () => Date.now().toString();\n\n  const sendMessage = useCallback(async (message: string) => {\n    if (!message.trim()) return;\n\n    // Add user message to conversation\n    const userMessage: JeanMessage = {\n      id: generateMessageId(),\n      role: \'user\',\n      content: message,\n      timestamp: new Date(),\n    };\n\n    setConversation(prev => [...prev, userMessage]);\n    setIsTyping(true);\n\n    try {\n      // Prepare AI request\n      const aiRequest: AIRequest = {\n        prompt: message,\n        contextJson: JSON.stringify({\n          activeTab,\n          recentActions: [], // Would track recent user actions\n          currentView: activeTab?.type || \'web\',\n        }),\n      };\n\n      // Call AI backend\n      const response = await fetch(`${backendUrl}/ai/generate`, {\n        method: \'POST\',\n        headers: {\n          \'Content-Type\': \'application/json\',\n        },\n        body: JSON.stringify(aiRequest),\n      });\n\n      if (!response.ok) {\n        throw new Error(`AI service responded with ${response.status}`);\n      }\n\n      const aiResponse: AIResponse = await response.json();\n\n      // Add AI response to conversation\n      const assistantMessage: JeanMessage = {\n        id: generateMessageId(),\n        role: \'assistant\',\n        content: aiResponse.response,\n        timestamp: new Date(),\n        actions: aiResponse.actions,\n      };\n\n      setConversation(prev => [...prev, assistantMessage]);\n    } catch (error) {\n      console.error(\'Failed to get AI response:\', error);\n\n      // Add error message to conversation\n      const errorMessage: JeanMessage = {\n        id: generateMessageId(),\n        role: \'assistant\',\n        content: \'Sorry, I encountered an error while processing your request. Please try again.\',\n        timestamp: new Date(),\n      };\n\n      setConversation(prev => [...prev, errorMessage]);\n    } finally {\n      setIsTyping(false);\n    }\n  }, [backendUrl, activeTab]);\n\n  const executeAction = useCallback(async (action: JeanAction): Promise<void> => {\n    console.log(\'Executing Jean action:\', action);\n\n    switch (action.type) {\n      case \'open_tab\':\n        // Would integrate with tab management\n        console.log(\'Opening new tab:\', action.payload);\n        break;\n\n      case \'close_tab\':\n        // Would integrate with tab management\n        console.log(\'Closing tab:\', action.payload);\n        break;\n\n      case \'navigate\':\n        // Would integrate with navigation\n        console.log(\'Navigating to:\', action.payload);\n        break;\n\n      case \'open_local_path\':\n        // Would integrate with file system\n        console.log(\'Opening local path:\', action.payload);\n        break;\n\n      default:\n        console.warn(\'Unknown action type:\', action.type);\n    }\n  }, []);\n\n  const clearConversation = useCallback(() => {\n    setConversation([]);\n  }, []);\n\n  const setActiveTabContext = useCallback((tab: Tab | null) => {\n    setActiveTab(tab);\n  }, []);\n\n  // Speech-to-text placeholder hook\n  const useSpeechToText = () => {\n    const [isListening, setIsListening] = useState(false);\n    const [transcript, setTranscript] = useState(\'\');\n\n    const startListening = () => {\n      setIsListening(true);\n      // Would implement actual STT here\n      console.log(\'Starting speech recognition...\');\n    };\n\n    const stopListening = () => {\n      setIsListening(false);\n      // Would stop STT and get final transcript\n      console.log(\'Stopping speech recognition...\');\n    };\n\n    return {\n      isListening,\n      transcript,\n      startListening,\n      stopListening,\n    };\n  };\n\n  // Text-to-speech placeholder hook\n  const useTextToSpeech = () => {\n    const [isSpeaking, setIsSpeaking] = useState(false);\n\n    const speak = (text: string) => {\n      setIsSpeaking(true);\n      // Would implement actual TTS here\n      console.log(\'Speaking:\', text);\n      setTimeout(() => setIsSpeaking(false), 1000);\n    };\n\n    const stopSpeaking = () => {\n      setIsSpeaking(false);\n      // Would stop TTS\n      console.log(\'Stopping speech...\');\n    };\n\n    return {\n      isSpeaking,\n      speak,\n      stopSpeaking,\n    };\n  };\n\n  return {\n    conversation,\n    isTyping,\n    sendMessage,\n    executeAction,\n    clearConversation,\n    setActiveTabContext,\n    // Hook exports for component use\n    useSpeechToText,\n    useTextToSpeech,\n  };\n};\n</create-file>\n</function_calls>'}