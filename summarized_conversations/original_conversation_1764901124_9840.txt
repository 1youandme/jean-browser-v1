{'role': 'assistant', 'content': '\n<function_calls>\n<create-file file_path="src/components/LocalFileBrowser.tsx">\nimport React, { useState, useEffect } from \'react\';\nimport { Folder, File, ArrowLeft, ArrowRight, Home, Search, Grid, List, Plus } from \'lucide-react\';\nimport { invoke } from \'@tauri-apps/api/tauri\';\nimport { open } from \'@tauri-apps/api/shell\';\nimport { Tab, FileEntry } from \'../types\';\n\ninterface LocalFileBrowserProps {\n  tab?: Tab;\n}\n\nexport const LocalFileBrowser: React.FC<LocalFileBrowserProps> = ({ tab }) => {\n  const [currentPath, setCurrentPath] = useState(tab?.path || \'/\');\n  const [files, setFiles] = useState<FileEntry[]>([]);\n  const [viewMode, setViewMode] = useState<\'grid\' | \'list\'>(\'list\');\n  const [searchQuery, setSearchQuery] = useState(\'\');\n  const [isLoading, setIsLoading] = useState(false);\n\n  const loadDirectory = async (path: string) => {\n    setIsLoading(true);\n    try {\n      const entries = await invoke<FileEntry[]>(\'list_directory\', { path });\n      setFiles(entries);\n      setCurrentPath(path);\n    } catch (error) {\n      console.error(\'Failed to load directory:\', error);\n      // Fallback to some default files for demo\n      setFiles([\n        { name: \'Documents\', path: `${path}/Documents`, isDirectory: true },\n        { name: \'Downloads\', path: `${path}/Downloads`, isDirectory: true },\n        { name: \'Pictures\', path: `${path}/Pictures`, isDirectory: true },\n        { name: \'example.txt\', path: `${path}/example.txt`, isDirectory: false, size: 1024 },\n      ]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    loadDirectory(currentPath);\n  }, []);\n\n  const handleFileClick = async (entry: FileEntry) => {\n    if (entry.isDirectory) {\n      await loadDirectory(entry.path);\n    } else {\n      // Open file with system default application\n      try {\n        await invoke(\'open_in_system\', { path: entry.path });\n      } catch (error) {\n        console.error(\'Failed to open file:\', error);\n      }\n    }\n  };\n\n  const navigateToParent = () => {\n    const parentPath = currentPath.split(\'/\').slice(0, -1).join(\'/\') || \'/\';\n    loadDirectory(parentPath);\n  };\n\n  const navigateToHome = () => {\n    loadDirectory(\'/\'); // Would be user home directory in real implementation\n  };\n\n  const formatFileSize = (bytes?: number) => {\n    if (!bytes) return \'\';\n    const units = [\'B\', \'KB\', \'MB\', \'GB\'];\n    let size = bytes;\n    let unitIndex = 0;\n    while (size >= 1024 && unitIndex < units.length - 1) {\n      size /= 1024;\n      unitIndex++;\n    }\n    return `${size.toFixed(1)} ${units[unitIndex]}`;\n  };\n\n  const filteredFiles = files.filter(file =>\n    file.name.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const getFileIcon = (entry: FileEntry) => {\n    if (entry.isDirectory) {\n      return <Folder className="w-5 h-5 text-blue-500" />;\n    }\n    \n    const ext = entry.name.split(\'.\').pop()?.toLowerCase();\n    switch (ext) {\n      case \'txt\':\n      case \'md\':\n        return <File className="w-5 h-5 text-gray-500" />;\n      case \'pdf\':\n        return <File className="w-5 h-5 text-red-500" />;\n      case \'jpg\':\n      case \'jpeg\':\n      case \'png\':\n      case \'gif\':\n        return <File className="w-5 h-5 text-green-500" />;\n      case \'mp4\':\n      case \'avi\':\n      case \'mov\':\n        return <File className="w-5 h-5 text-purple-500" />;\n      default:\n        return <File className="w-5 h-5 text-gray-500" />;\n    }\n  };\n\n  return (\n    <div className="flex-1 flex flex-col bg-gray-50">\n      {/* Toolbar */}\n      <div className="h-12 bg-white border-b border-gray-200 flex items-center px-4 gap-4">\n        {/* Navigation */}\n        <div className="flex items-center gap-2">\n          <button\n            onClick={navigateToParent}\n            className="p-1 hover:bg-gray-100 rounded transition-colors"\n            title="Go to parent directory"\n          >\n            <ArrowLeft className="w-4 h-4" />\n          </button>\n          <button\n            className="p-1 hover:bg-gray-100 rounded transition-colors"\n            title="Go forward"\n          >\n            <ArrowRight className="w-4 h-4" />\n          </button>\n          <button\n            onClick={navigateToHome}\n            className="p-1 hover:bg-gray-100 rounded transition-colors"\n            title="Go to home directory"\n          >\n            <Home className="w-4 h-4" />\n          </button>\n        </div>\n\n        {/* Path */}\n        <div className="flex-1 px-3 py-1 bg-gray-50 border border-gray-300 rounded text-sm text-gray-600 truncate">\n          {currentPath}\n        </div>\n\n        {/* Search */}\n        <div className="relative">\n          <Search className="absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400" />\n          <input\n            type="text"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            placeholder="Search files..."\n            className="pl-8 pr-3 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"\n          />\n        </div>\n\n        {/* View Mode */}\n        <div className="flex items-center gap-1">\n          <button\n            onClick={() => setViewMode(\'list\')}\n            className={`p-1 rounded transition-colors ${\n              viewMode === \'list\' ? \'bg-gray-200\' : \'hover:bg-gray-100\'\n            }`}\n            title="List view"\n          >\n            <List className="w-4 h-4" />\n          </button>\n          <button\n            onClick={() => setViewMode(\'grid\')}\n            className={`p-1 rounded transition-colors ${\n              viewMode === \'grid\' ? \'bg-gray-200\' : \'hover:bg-gray-100\'\n            }`}\n            title="Grid view"\n          >\n            <Grid className="w-4 h-4" />\n          </button>\n        </div>\n      </div>\n\n      {/* File List */}\n      <div className="flex-1 overflow-auto">\n        {isLoading ? (\n          <div className="flex items-center justify-center h-full">\n            <div className="text-gray-500">Loading...</div>\n          </div>\n        ) : viewMode === \'list\' ? (\n          <table className="w-full">\n            <thead className="bg-gray-100 border-b border-gray-200">\n              <tr className="text-left">\n                <th className="px-4 py-2 text-sm font-medium text-gray-700">Name</th>\n                <th className="px-4 py-2 text-sm font-medium text-gray-700">Size</th>\n                <th className="px-4 py-2 text-sm font-medium text-gray-700">Modified</th>\n              </tr>\n            </thead>\n            <tbody>\n              {filteredFiles.map((entry, index) => (\n                <tr\n                  key={index}\n                  onClick={() => handleFileClick(entry)}\n                  className="border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition-colors"\n                >\n                  <td className="px-4 py-2 flex items-center gap-2">\n                    {getFileIcon(entry)}\n                    <span className={entry.isDirectory ? \'font-medium\' : \'\'}>\n                      {entry.name}\n                    </span>\n                  </td>\n                  <td className="px-4 py-2 text-sm text-gray-600">\n                    {entry.isDirectory ? \'‚Äî\' : formatFileSize(entry.size)}\n                  </td>\n                  <td className="px-4 py-2 text-sm text-gray-600">\n                    {entry.modified ? new Date(entry.modified).toLocaleDateString() : \'‚Äî\'}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        ) : (\n          <div className="p-4 grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-4">\n            {filteredFiles.map((entry, index) => (\n              <div\n                key={index}\n                onClick={() => handleFileClick(entry)}\n                className="flex flex-col items-center gap-2 p-3 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors"\n              >\n                <div className="w-12 h-12 flex items-center justify-center">\n                  {getFileIcon(entry)}\n                </div>\n                <span className="text-xs text-center truncate w-full">\n                  {entry.name}\n                </span>\n              </div>\n            ))}\n          </div>\n        )}\n\n        {filteredFiles.length === 0 && !isLoading && (\n          <div className="flex items-center justify-center h-full">\n            <div className="text-center">\n              <div className="text-4xl mb-4">üìÅ</div>\n              <p className="text-gray-500">No files found</p>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Status Bar */}\n      <div className="h-6 bg-gray-100 border-t border-gray-200 flex items-center justify-between px-4">\n        <div className="text-xs text-gray-600">\n          {filteredFiles.length} item{filteredFiles.length !== 1 ? \'s\' : \'\'}\n        </div>\n        <div className="text-xs text-gray-500">\n          {currentPath}\n        </div>\n      </div>\n    </div>\n  );\n};\n</create-file>\n</function_calls>'}