{'role': 'assistant', 'content': '\n### üåê **ÿÆÿßŸÖÿ≥ÿßŸã: ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿÆÿØŸÖÿßÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©**\n\n<function_calls>\n<create-file file_path="src/services/auth.service.ts">\nimport { User, LoginData, RegisterData } from \'@/types\';\n\nclass AuthService {\n  private readonly baseUrl = \'/api/auth\';\n\n  async login(credentials: LoginData): Promise<{ user: User; token: string }> {\n    const response = await fetch(`${this.baseUrl}/login`, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n      },\n      body: JSON.stringify(credentials),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || \'Login failed\');\n    }\n\n    return response.json();\n  }\n\n  async register(userData: RegisterData): Promise<{ user: User; token: string }> {\n    const response = await fetch(`${this.baseUrl}/register`, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n      },\n      body: JSON.stringify(userData),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || \'Registration failed\');\n    }\n\n    return response.json();\n  }\n\n  async logout(token: string): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/logout`, {\n      method: \'POST\',\n      headers: {\n        \'Authorization\': `Bearer ${token}`,\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(\'Logout failed\');\n    }\n  }\n\n  async refreshToken(refreshToken: string): Promise<{ token: string }> {\n    const response = await fetch(`${this.baseUrl}/refresh`, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n      },\n      body: JSON.stringify({ refreshToken }),\n    });\n\n    if (!response.ok) {\n      throw new Error(\'Token refresh failed\');\n    }\n\n    return response.json();\n  }\n\n  async getCurrentUser(token: string): Promise<User> {\n    const response = await fetch(`${this.baseUrl}/me`, {\n      headers: {\n        \'Authorization\': `Bearer ${token}`,\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(\'Failed to get current user\');\n    }\n\n    return response.json();\n  }\n\n  async updateProfile(token: string, updates: Partial<User>): Promise<User> {\n    const response = await fetch(`${this.baseUrl}/profile`, {\n      method: \'PUT\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n        \'Authorization\': `Bearer ${token}`,\n      },\n      body: JSON.stringify(updates),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || \'Profile update failed\');\n    }\n\n    return response.json();\n  }\n\n  async changePassword(token: string, currentPassword: string, newPassword: string): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/change-password`, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n        \'Authorization\': `Bearer ${token}`,\n      },\n      body: JSON.stringify({ currentPassword, newPassword }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || \'Password change failed\');\n    }\n  }\n\n  async requestPasswordReset(email: string): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/request-reset`, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n      },\n      body: JSON.stringify({ email }),\n    });\n\n    if (!response.ok) {\n      throw new Error(\'Password reset request failed\');\n    }\n  }\n\n  async resetPassword(token: string, newPassword: string): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/reset-password`, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n      },\n      body: JSON.stringify({ token, newPassword }),\n    });\n\n    if (!response.ok) {\n      throw new Error(\'Password reset failed\');\n    }\n  }\n\n  async deleteAccount(token: string, password: string): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/delete-account`, {\n      method: \'DELETE\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n        \'Authorization\': `Bearer ${token}`,\n      },\n      body: JSON.stringify({ password }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || \'Account deletion failed\');\n    }\n  }\n\n  async verifyEmail(token: string): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/verify-email`, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n      },\n      body: JSON.stringify({ token }),\n    });\n\n    if (!response.ok) {\n      throw new Error(\'Email verification failed\');\n    }\n  }\n\n  async enable2FA(token: string): Promise<{ qrCode: string; secret: string }> {\n    const response = await fetch(`${this.baseUrl}/2fa/enable`, {\n      method: \'POST\',\n      headers: {\n        \'Authorization\': `Bearer ${token}`,\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(\'2FA enable failed\');\n    }\n\n    return response.json();\n  }\n\n  async confirm2FA(token: string, code: string, secret: string): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/2fa/confirm`, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n        \'Authorization\': `Bearer ${token}`,\n      },\n      body: JSON.stringify({ code, secret }),\n    });\n\n    if (!response.ok) {\n      throw new Error(\'2FA confirmation failed\');\n    }\n  }\n\n  async disable2FA(token: string, code: string): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/2fa/disable`, {\n      method: \'POST\',\n      headers: {\n        \'Content-Type\': \'application/json\',\n        \'Authorization\': `Bearer ${token}`,\n      },\n      body: JSON.stringify({ code }),\n    });\n\n    if (!response.ok) {\n      throw new Error(\'2FA disable failed\');\n    }\n  }\n\n  // Utility method to check if token is expired\n  isTokenExpired(token: string): boolean {\n    try {\n      const payload = JSON.parse(atob(token.split(\'.\')[1]));\n      const currentTime = Date.now() / 1000;\n      return payload.exp < currentTime;\n    } catch {\n      return true;\n    }\n  }\n\n  // Utility method to get token expiration time\n  getTokenExpiration(token: string): Date | null {\n    try {\n      const payload = JSON.parse(atob(token.split(\'.\')[1]));\n      return new Date(payload.exp * 1000);\n    } catch {\n      return null;\n    }\n  }\n}\n\nexport const authService = new AuthService();\n</create-file>\n</function_calls>'}