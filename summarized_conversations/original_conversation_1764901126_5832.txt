{'role': 'assistant', 'content': '\n<function_calls>\n<create-file file_path="src/services/realestate.ts">\n// Real Estate Service Interface and Implementation\nexport interface Property {\n  id: string;\n  title: string;\n  description: string;\n  type: \'apartment\' | \'house\' | \'condo\' | \'townhouse\' | \'villa\' | \'land\' | \'commercial\';\n  status: \'for_sale\' | \'for_rent\' | \'sold\' | \'rented\' | \'off_market\';\n  price: number;\n  currency: string;\n  pricingType: \'fixed\' | \'auction\' | \'rental\';\n  address: Address;\n  location: {\n    lat: number;\n    lng: number;\n    city: string;\n    state: string;\n    country: string;\n    neighborhood?: string;\n  };\n  features: PropertyFeatures;\n  images: string[];\n  videos?: string[];\n  virtualTour?: string;\n  floorPlan?: string;\n  agent: Agent;\n  listing: ListingInfo;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface Address {\n  street: string;\n  apartment?: string;\n  city: string;\n  state: string;\n  zipCode: string;\n  country: string;\n}\n\nexport interface PropertyFeatures {\n  bedrooms: number;\n  bathrooms: number;\n  squareFeet: number;\n  lotSize?: number;\n  yearBuilt?: number;\n  parking: {\n    spaces: number;\n    type: \'garage\' | \'carport\' | \'street\' | \'driveway\';\n  };\n  amenities: string[];\n  features: string[];\n  utilities: string[];\n  heating: string;\n  cooling: string;\n  foundation?: string;\n  roof?: string;\n  exterior: string;\n  interior: string;\n}\n\nexport interface Agent {\n  id: string;\n  name: string;\n  email: string;\n  phone: string;\n  photo?: string;\n  agency: string;\n  license: string;\n  rating: number;\n  reviews: number;\n  languages: string[];\n  specialties: string[];\n}\n\nexport interface ListingInfo {\n  listingId: string;\n  mlsId?: string;\n  listedAt: Date;\n  views: number;\n  saves: number;\n  inquiries: number;\n  openHouses: OpenHouse[];\n  documents: PropertyDocument[];\n}\n\nexport interface OpenHouse {\n  id: string;\n  date: Date;\n  startTime: string;\n  endTime: string;\n  description?: string;\n  rsvpRequired: boolean;\n  maxAttendees?: number;\n  currentAttendees: number;\n}\n\nexport interface PropertyDocument {\n  id: string;\n  name: string;\n  type: \'disclosure\' | \'inspection\' | \'title\' | \'lease\' | \'other\';\n  url: string;\n  uploadedAt: Date;\n}\n\nexport interface PropertySearch {\n  location?: string;\n  type?: string;\n  status?: string;\n  priceMin?: number;\n  priceMax?: number;\n  bedroomsMin?: number;\n  bedroomsMax?: number;\n  bathroomsMin?: number;\n  bathroomsMax?: number;\n  squareFeetMin?: number;\n  squareFeetMax?: number;\n  amenities?: string[];\n  features?: string[];\n  keywords?: string;\n  sortBy?: \'price_asc\' | \'price_desc\' | \'newest\' | \'bedrooms\' | \'square_feet\';\n}\n\nexport interface RealEstateService {\n  // Property search and browsing\n  searchProperties: (search: PropertySearch) => Promise<Property[]>;\n  getProperty: (id: string) => Promise<Property>;\n  getFeaturedProperties: () => Promise<Property[]>;\n  getSimilarProperties: (propertyId: string) => Promise<Property[]>;\n  getRecentlyViewed: () => Promise<Property[]>;\n  \n  // User interactions\n  saveProperty: (propertyId: string) => Promise<void>;\n  unsaveProperty: (propertyId: string) => Promise<void>;\n  getSavedProperties: () => Promise<Property[]>;\n  scheduleViewing: (propertyId: string, date: Date, time: string) => Promise<Viewing>;\n  getPropertyViewings: (propertyId: string) => Promise<Viewing[]>;\n  \n  // Agent communication\n  contactAgent: (propertyId: string, message: string, contactInfo: ContactInfo) => Promise<void>;\n  getAgentProperties: (agentId: string) => Promise<Property[]>;\n  rateAgent: (agentId: string, rating: number, review: string) => Promise<void>;\n  \n  // Valuation and analytics\n  getPropertyValuation: (address: Address) => Promise<PropertyValuation>;\n  getMarketTrends: (location: string) => Promise<MarketTrends>;\n  getNeighborhoodInfo: (location: string) => Promise<NeighborhoodInfo>;\n  \n  // Mortgage calculator\n  calculateMortgage: (principal: number, rate: number, years: number, downPayment?: number) => Promise<MortgageCalculation>;\n  \n  // Virtual tours\n  startVirtualTour: (propertyId: string) => Promise<string>;\n  scheduleVirtualViewing: (propertyId: string, date: Date) => Promise<VirtualViewing>;\n}\n\nexport interface Viewing {\n  id: string;\n  propertyId: string;\n  date: Date;\n  time: string;\n  duration: number;\n  type: \'in_person\' | \'virtual\';\n  status: \'scheduled\' | \'confirmed\' | \'completed\' | \'cancelled\';\n  notes?: string;\n  createdAt: Date;\n}\n\nexport interface ContactInfo {\n  name: string;\n  email: string;\n  phone?: string;\n  message: string;\n  preferredContact: \'email\' | \'phone\';\n}\n\nexport interface PropertyValuation {\n  estimatedValue: number;\n  confidence: number;\n  comparableProperties: Property[];\n  marketAnalysis: {\n    pricePerSquareFoot: number;\n    averageDaysOnMarket: number;\n    priceTrend: \'rising\' | \'stable\' | \'declining\';\n  };\n  lastUpdated: Date;\n}\n\nexport interface MarketTrends {\n  location: string;\n  medianPrice: number;\n  averagePricePerSquareFoot: number;\n  inventory: number;\n  daysOnMarket: number;\n  priceTrend: {\n    direction: \'up\' | \'down\' | \'stable\';\n    percentage: number;\n    period: string;\n  };\n  marketHeat: \'cold\' | \'cool\' | \'warm\' | \'hot\';\n  lastUpdated: Date;\n}\n\nexport interface NeighborhoodInfo {\n  name: string;\n  description: string;\n  demographics: {\n    population: number;\n    medianIncome: number;\n    medianAge: number;\n  };\n  amenities: {\n    schools: School[];\n    parks: string[];\n    shopping: string[];\n    restaurants: string[];\n    hospitals: string[];\n  };\n  transportation: {\n    publicTransit: boolean;\n    highways: string[];\n    airports: string[];\n  };\n  crime: {\n    safetyRating: number;\n    crimeRate: number;\n  };\n  walkScore: number;\n  transitScore: number;\n  bikeScore: number;\n}\n\nexport interface School {\n  name: string;\n  type: \'elementary\' | \'middle\' | \'high\' | \'private\';\n  rating: number;\n  distance: number;\n  grades: string[];\n}\n\nexport interface MortgageCalculation {\n  monthlyPayment: number;\n  totalPayment: number;\n  totalInterest: number;\n  amortization: AmortizationEntry[];\n}\n\nexport interface AmortizationEntry {\n  month: number;\n  payment: number;\n  principal: number;\n  interest: number;\n  balance: number;\n}\n\nexport interface VirtualViewing {\n  id: string;\n  propertyId: string;\n  date: Date;\n  duration: number;\n  meetingUrl: string;\n  status: \'scheduled\' | \'active\' | \'completed\' | \'cancelled\';\n  participantLimit: number;\n  currentParticipants: number;\n}\n\nclass RealEstateServiceImpl implements RealEstateService {\n  private baseUrl: string;\n\n  constructor(baseUrl: string = \'http://localhost:8080\') {\n    this.baseUrl = baseUrl;\n  }\n\n  async searchProperties(search: PropertySearch): Promise<Property[]> {\n    const params = new URLSearchParams();\n    Object.entries(search).forEach(([key, value]) => {\n      if (value !== undefined) {\n        if (Array.isArray(value)) {\n          value.forEach(v => params.append(key, v));\n        } else {\n          params.append(key, String(value));\n        }\n      }\n    });\n\n    const response = await fetch(`${this.baseUrl}/api/real-estate/properties/search?${params}`);\n    if (!response.ok) throw new Error(\'Failed to search properties\');\n    return response.json();\n  }\n\n  async getProperty(id: string): Promise<Property> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/properties/${id}`);\n    if (!response.ok) throw new Error(\'Failed to get property\');\n    return response.json();\n  }\n\n  async getFeaturedProperties(): Promise<Property[]> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/properties/featured`);\n    if (!response.ok) throw new Error(\'Failed to get featured properties\');\n    return response.json();\n  }\n\n  async getSimilarProperties(propertyId: string): Promise<Property[]> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/properties/${propertyId}/similar`);\n    if (!response.ok) throw new Error(\'Failed to get similar properties\');\n    return response.json();\n  }\n\n  async getRecentlyViewed(): Promise<Property[]> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/properties/recently-viewed`);\n    if (!response.ok) throw new Error(\'Failed to get recently viewed properties\');\n    return response.json();\n  }\n\n  async saveProperty(propertyId: string): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/properties/${propertyId}/save`, {\n      method: \'POST\',\n    });\n    if (!response.ok) throw new Error(\'Failed to save property\');\n  }\n\n  async unsaveProperty(propertyId: string): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/properties/${propertyId}/save`, {\n      method: \'DELETE\',\n    });\n    if (!response.ok) throw new Error(\'Failed to unsave property\');\n  }\n\n  async getSavedProperties(): Promise<Property[]> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/properties/saved`);\n    if (!response.ok) throw new Error(\'Failed to get saved properties\');\n    return response.json();\n  }\n\n  async scheduleViewing(propertyId: string, date: Date, time: string): Promise<Viewing> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/properties/${propertyId}/viewings`, {\n      method: \'POST\',\n      headers: { \'Content-Type\': \'application/json\' },\n      body: JSON.stringify({ date, time }),\n    });\n    if (!response.ok) throw new Error(\'Failed to schedule viewing\');\n    return response.json();\n  }\n\n  async getPropertyViewings(propertyId: string): Promise<Viewing[]> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/properties/${propertyId}/viewings`);\n    if (!response.ok) throw new Error(\'Failed to get property viewings\');\n    return response.json();\n  }\n\n  async contactAgent(propertyId: string, message: string, contactInfo: ContactInfo): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/properties/${propertyId}/contact`, {\n      method: \'POST\',\n      headers: { \'Content-Type\': \'application/json\' },\n      body: JSON.stringify({ message, contactInfo }),\n    });\n    if (!response.ok) throw new Error(\'Failed to contact agent\');\n  }\n\n  async getAgentProperties(agentId: string): Promise<Property[]> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/agents/${agentId}/properties`);\n    if (!response.ok) throw new Error(\'Failed to get agent properties\');\n    return response.json();\n  }\n\n  async rateAgent(agentId: string, rating: number, review: string): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/agents/${agentId}/rate`, {\n      method: \'POST\',\n      headers: { \'Content-Type\': \'application/json\' },\n      body: JSON.stringify({ rating, review }),\n    });\n    if (!response.ok) throw new Error(\'Failed to rate agent\');\n  }\n\n  async getPropertyValuation(address: Address): Promise<PropertyValuation> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/valuation`, {\n      method: \'POST\',\n      headers: { \'Content-Type\': \'application/json\' },\n      body: JSON.stringify({ address }),\n    });\n    if (!response.ok) throw new Error(\'Failed to get property valuation\');\n    return response.json();\n  }\n\n  async getMarketTrends(location: string): Promise<MarketTrends> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/market-trends/${encodeURIComponent(location)}`);\n    if (!response.ok) throw new Error(\'Failed to get market trends\');\n    return response.json();\n  }\n\n  async getNeighborhoodInfo(location: string): Promise<NeighborhoodInfo> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/neighborhood/${encodeURIComponent(location)}`);\n    if (!response.ok) throw new Error(\'Failed to get neighborhood info\');\n    return response.json();\n  }\n\n  async calculateMortgage(principal: number, rate: number, years: number, downPayment?: number): Promise<MortgageCalculation> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/mortgage-calculator`, {\n      method: \'POST\',\n      headers: { \'Content-Type\': \'application/json\' },\n      body: JSON.stringify({ principal, rate, years, downPayment }),\n    });\n    if (!response.ok) throw new Error(\'Failed to calculate mortgage\');\n    return response.json();\n  }\n\n  async startVirtualTour(propertyId: string): Promise<string> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/properties/${propertyId}/virtual-tour`, {\n      method: \'POST\',\n    });\n    if (!response.ok) throw new Error(\'Failed to start virtual tour\');\n    const result = await response.json();\n    return result.tourUrl;\n  }\n\n  async scheduleVirtualViewing(propertyId: string, date: Date): Promise<VirtualViewing> {\n    const response = await fetch(`${this.baseUrl}/api/real-estate/properties/${propertyId}/virtual-viewings`, {\n      method: \'POST\',\n      headers: { \'Content-Type\': \'application/json\' },\n      body: JSON.stringify({ date }),\n    });\n    if (!response.ok) throw new Error(\'Failed to schedule virtual viewing\');\n    return response.json();\n  }\n}\n\nexport const realEstateService = new RealEstateServiceImpl();\nexport const useRealEstateService = () => realEstateService;\n</create-file>\n</function_calls>'}