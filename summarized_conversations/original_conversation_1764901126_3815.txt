{'role': 'assistant', 'content': '\n<function_calls>\n<create-file file_path="src/services/delivery.ts">\n// Delivery Service Interface and Implementation\nexport interface DeliveryOrder {\n  id: string;\n  orderType: \'food\' | \'package\' | \'grocery\' | \'medicine\';\n  items: DeliveryItem[];\n  pickup: Address;\n  delivery: Address;\n  status: \'pending\' | \'accepted\' | \'picking_up\' | \'in_transit\' | \'delivered\' | \'cancelled\';\n  courier?: Courier;\n  estimatedTime?: Date;\n  actualTime?: Date;\n  price: {\n    base: number;\n    tax: number;\n    tip: number;\n    total: number;\n    currency: string;\n  };\n  paymentMethod: string;\n  instructions?: string;\n  trackingCode: string;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface DeliveryItem {\n  id: string;\n  name: string;\n  description?: string;\n  quantity: number;\n  unit: string;\n  price: number;\n  currency: string;\n}\n\nexport interface Address {\n  street: string;\n  apartment?: string;\n  city: string;\n  state: string;\n  zipCode: string;\n  country: string;\n  coordinates?: {\n    lat: number;\n    lng: number;\n  };\n}\n\nexport interface Courier {\n  id: string;\n  name: string;\n  phone: string;\n  photo?: string;\n  vehicle: {\n    type: \'car\' | \'motorcycle\' | \'bicycle\' | \'truck\';\n    make: string;\n    model: string;\n    color: string;\n    plateNumber: string;\n  };\n  rating: number;\n  deliveriesCompleted: number;\n}\n\nexport interface DeliveryService {\n  // Order management\n  createOrder: (order: Omit<DeliveryOrder, \'id\' | \'status\' | \'trackingCode\' | \'createdAt\' | \'updatedAt\'>) => Promise<DeliveryOrder>;\n  getOrders: () => Promise<DeliveryOrder[]>;\n  getOrder: (id: string) => Promise<DeliveryOrder>;\n  cancelOrder: (id: string, reason?: string) => Promise<void>;\n  updateOrder: (id: string, updates: Partial<DeliveryOrder>) => Promise<void>;\n  \n  // Tracking\n  trackOrder: (trackingCode: string) => Promise<DeliveryOrder>;\n  getOrderHistory: (limit?: number) => Promise<DeliveryOrder[]>;\n  \n  // Restaurant/Store management (for food delivery)\n  getRestaurants: (location?: Address) => Promise<Restaurant[]>;\n  getRestaurant: (id: string) => Promise<Restaurant>;\n  getRestaurantMenu: (restaurantId: string) => Promise<MenuItem[]>;\n  \n  // Package delivery\n  getShippingRates: (pickup: Address, delivery: Address, packageInfo: PackageInfo) => Promise<ShippingRate[]>;\n  schedulePickup: (pickupInfo: PickupInfo) => Promise<DeliveryOrder>;\n  \n  // Real-time updates\n  subscribeToOrderUpdates: (orderId: string, callback: (order: DeliveryOrder) => void) => () => void;\n  getCurrentLocation: () => Promise<{ lat: number; lng: number }>;\n}\n\nexport interface Restaurant {\n  id: string;\n  name: string;\n  description: string;\n  cuisine: string[];\n  address: Address;\n  phone: string;\n  email: string;\n  website?: string;\n  rating: number;\n  priceRange: \'$\' | \'$$\' | \'$$$\' | \'$$$$\';\n  deliveryTime: {\n    min: number;\n    max: number;\n  };\n  deliveryFee: {\n    min: number;\n    max: number;\n  };\n  imageUrl?: string;\n  isOpen: boolean;\n  hours: {\n    [key: string]: {\n      open: string;\n      close: string;\n    };\n  };\n}\n\nexport interface MenuItem {\n  id: string;\n  name: string;\n  description: string;\n  price: number;\n  currency: string;\n  category: string;\n  imageUrl?: string;\n  isAvailable: boolean;\n  preparationTime: number;\n  ingredients: string[];\n  allergens: string[];\n  nutrition?: {\n    calories: number;\n    protein: number;\n    carbs: number;\n    fat: number;\n  };\n}\n\nexport interface PackageInfo {\n  weight: number;\n  dimensions: {\n    length: number;\n    width: number;\n    height: number;\n  };\n  type: \'document\' | \'package\' | \'furniture\' | \'electronics\' | \'other\';\n  value?: number;\n  insurance?: boolean;\n}\n\nexport interface ShippingRate {\n  provider: string;\n  service: string;\n  price: number;\n  currency: string;\n  estimatedDelivery: Date;\n  tracking: boolean;\n}\n\nexport interface PickupInfo {\n  packageInfo: PackageInfo;\n  pickup: Address;\n  delivery: Address;\n  preferredTime?: Date;\n  instructions?: string;\n}\n\nclass DeliveryServiceImpl implements DeliveryService {\n  private baseUrl: string;\n\n  constructor(baseUrl: string = \'http://localhost:8080\') {\n    this.baseUrl = baseUrl;\n  }\n\n  async createOrder(order: Omit<DeliveryOrder, \'id\' | \'status\' | \'trackingCode\' | \'createdAt\' | \'updatedAt\'>): Promise<DeliveryOrder> {\n    const response = await fetch(`${this.baseUrl}/api/delivery/orders`, {\n      method: \'POST\',\n      headers: { \'Content-Type\': \'application/json\' },\n      body: JSON.stringify(order),\n    });\n    if (!response.ok) throw new Error(\'Failed to create delivery order\');\n    return response.json();\n  }\n\n  async getOrders(): Promise<DeliveryOrder[]> {\n    const response = await fetch(`${this.baseUrl}/api/delivery/orders`);\n    if (!response.ok) throw new Error(\'Failed to get delivery orders\');\n    return response.json();\n  }\n\n  async getOrder(id: string): Promise<DeliveryOrder> {\n    const response = await fetch(`${this.baseUrl}/api/delivery/orders/${id}`);\n    if (!response.ok) throw new Error(\'Failed to get delivery order\');\n    return response.json();\n  }\n\n  async cancelOrder(id: string, reason?: string): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/api/delivery/orders/${id}/cancel`, {\n      method: \'POST\',\n      headers: { \'Content-Type\': \'application/json\' },\n      body: JSON.stringify({ reason }),\n    });\n    if (!response.ok) throw new Error(\'Failed to cancel delivery order\');\n  }\n\n  async updateOrder(id: string, updates: Partial<DeliveryOrder>): Promise<void> {\n    const response = await fetch(`${this.baseUrl}/api/delivery/orders/${id}`, {\n      method: \'PUT\',\n      headers: { \'Content-Type\': \'application/json\' },\n      body: JSON.stringify(updates),\n    });\n    if (!response.ok) throw new Error(\'Failed to update delivery order\');\n  }\n\n  async trackOrder(trackingCode: string): Promise<DeliveryOrder> {\n    const response = await fetch(`${this.baseUrl}/api/delivery/track/${trackingCode}`);\n    if (!response.ok) throw new Error(\'Failed to track delivery order\');\n    return response.json();\n  }\n\n  async getOrderHistory(limit?: number): Promise<DeliveryOrder[]> {\n    const url = limit ? `${this.baseUrl}/api/delivery/orders/history?limit=${limit}` : `${this.baseUrl}/api/delivery/orders/history`;\n    const response = await fetch(url);\n    if (!response.ok) throw new Error(\'Failed to get order history\');\n    return response.json();\n  }\n\n  async getRestaurants(location?: Address): Promise<Restaurant[]> {\n    const params = location ? new URLSearchParams({\n      lat: location.coordinates?.lat.toString(),\n      lng: location.coordinates?.lng.toString(),\n    }) : \'\';\n\n    const response = await fetch(`${this.baseUrl}/api/delivery/restaurants?${params}`);\n    if (!response.ok) throw new Error(\'Failed to get restaurants\');\n    return response.json();\n  }\n\n  async getRestaurant(id: string): Promise<Restaurant> {\n    const response = await fetch(`${this.baseUrl}/api/delivery/restaurants/${id}`);\n    if (!response.ok) throw new Error(\'Failed to get restaurant\');\n    return response.json();\n  }\n\n  async getRestaurantMenu(restaurantId: string): Promise<MenuItem[]> {\n    const response = await fetch(`${this.baseUrl}/api/delivery/restaurants/${restaurantId}/menu`);\n    if (!response.ok) throw new Error(\'Failed to get restaurant menu\');\n    return response.json();\n  }\n\n  async getShippingRates(pickup: Address, delivery: Address, packageInfo: PackageInfo): Promise<ShippingRate[]> {\n    const response = await fetch(`${this.baseUrl}/api/delivery/shipping-rates`, {\n      method: \'POST\',\n      headers: { \'Content-Type\': \'application/json\' },\n      body: JSON.stringify({ pickup, delivery, packageInfo }),\n    });\n    if (!response.ok) throw new Error(\'Failed to get shipping rates\');\n    return response.json();\n  }\n\n  async schedulePickup(pickupInfo: PickupInfo): Promise<DeliveryOrder> {\n    const response = await fetch(`${this.baseUrl}/api/delivery/pickup`, {\n      method: \'POST\',\n      headers: { \'Content-Type\': \'application/json\' },\n      body: JSON.stringify(pickupInfo),\n    });\n    if (!response.ok) throw new Error(\'Failed to schedule pickup\');\n    return response.json();\n  }\n\n  subscribeToOrderUpdates(orderId: string, callback: (order: DeliveryOrder) => void): () => void {\n    // Would implement WebSocket connection for real-time updates\n    console.log(\'Subscribing to order updates for:\', orderId);\n    \n    // Return unsubscribe function\n    return () => {\n      console.log(\'Unsubscribing from order updates for:\', orderId);\n    };\n  }\n\n  async getCurrentLocation(): Promise<{ lat: number; lng: number }> {\n    // Would use browser\'s geolocation API\n    return new Promise((resolve, reject) => {\n      navigator.geolocation.getCurrentPosition(\n        (position) => resolve({\n          lat: position.coords.latitude,\n          lng: position.coords.longitude,\n        }),\n        reject\n      );\n    });\n  }\n}\n\nexport const deliveryService = new DeliveryServiceImpl();\nexport const useDeliveryService = () => deliveryService;\n</create-file>\n</function_calls>'}