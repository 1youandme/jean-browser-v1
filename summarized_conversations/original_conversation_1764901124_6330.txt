{'role': 'assistant', 'content': '\n<function_calls>\n<create-file file_path="src/components/JeanAssistant.tsx">\nimport React, { useState, useRef, useEffect } from \'react\';\nimport { Send, Mic, Volume2, X, Check, AlertCircle } from \'lucide-react\';\nimport { JeanMessage, JeanAction, Tab } from \'../types\';\n\ninterface JeanAssistantProps {\n  conversation: JeanMessage[];\n  isTyping: boolean;\n  onSendMessage: (message: string) => Promise<void>;\n  onAction: (action: JeanAction) => Promise<void>;\n  onClose: () => void;\n  activeTab?: Tab;\n}\n\nexport const JeanAssistant: React.FC<JeanAssistantProps> = ({\n  conversation,\n  isTyping,\n  onSendMessage,\n  onAction,\n  onClose,\n  activeTab,\n}) => {\n  const [inputMessage, setInputMessage] = useState(\'\');\n  const [isListening, setIsListening] = useState(false);\n  const [pendingActions, setPendingActions] = useState<JeanAction[]>([]);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \'smooth\' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [conversation]);\n\n  const handleSendMessage = async () => {\n    if (!inputMessage.trim()) return;\n    \n    const message = inputMessage.trim();\n    setInputMessage(\'\');\n    \n    // Include context about current tab\n    const contextMessage = message + (\n      activeTab ? `\\n\\nContext: Currently viewing ${activeTab.title} (${activeTab.type}: ${activeTab.url || activeTab.path})` : \'\'\n    );\n    \n    await onSendMessage(contextMessage);\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === \'Enter\' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  const toggleListening = () => {\n    setIsListening(!isListening);\n    // STT implementation would go here\n  };\n\n  const handleActionApproval = async (action: JeanAction, approved: boolean) => {\n    setPendingActions(pendingActions.filter(a => a !== action));\n    \n    if (approved) {\n      try {\n        await onAction(action);\n      } catch (error) {\n        console.error(\'Failed to execute action:\', error);\n      }\n    }\n  };\n\n  const formatActionDescription = (action: JeanAction): string => {\n    switch (action.type) {\n      case \'open_tab\':\n        return `Open new ${action.targetBar} tab${action.payload.url ? ` to ${action.payload.url}` : \'\'}`;\n      case \'close_tab\':\n        return \'Close current tab\';\n      case \'navigate\':\n        return `Navigate to ${action.payload.url || action.payload.path}`;\n      case \'open_local_path\':\n        return `Open local path: ${action.payload.path}`;\n      default:\n        return `Execute action: ${action.type}`;\n    }\n  };\n\n  return (\n    <div className="h-full flex flex-col bg-white">\n      {/* Header */}\n      <div className="h-12 border-b border-gray-200 flex items-center justify-between px-4 bg-gradient-to-r from-blue-50 to-indigo-50">\n        <div className="flex items-center gap-2">\n          <div className="w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center">\n            <span className="text-white text-xs font-bold">J</span>\n          </div>\n          <span className="font-medium text-gray-900">Jean Assistant</span>\n        </div>\n        <button\n          onClick={onClose}\n          className="p-1 hover:bg-gray-200 rounded transition-colors"\n        >\n          <X className="w-4 h-4" />\n        </button>\n      </div>\n\n      {/* Conversation */}\n      <div className="flex-1 overflow-y-auto p-4 space-y-4">\n        {conversation.map((message) => (\n          <div\n            key={message.id}\n            className={`flex ${message.role === \'user\' ? \'justify-end\' : \'justify-start\'}`}\n          >\n            <div\n              className={`max-w-[80%] rounded-lg px-3 py-2 ${\n                message.role === \'user\'\n                  ? \'bg-blue-600 text-white\'\n                  : \'bg-gray-100 text-gray-900\'\n              }`}\n            >\n              <p className="text-sm whitespace-pre-wrap">{message.content}</p>\n              \n              {/* Actions from Jean */}\n              {message.actions && message.actions.length > 0 && (\n                <div className="mt-2 space-y-2">\n                  {message.actions.map((action, index) => (\n                    <div key={index} className="bg-white/20 rounded p-2 text-xs">\n                      <div className="font-medium mb-1">Suggested Action:</div>\n                      <div className="mb-2">{formatActionDescription(action)}</div>\n                      <div className="flex gap-2">\n                        <button\n                          onClick={() => handleActionApproval(action, true)}\n                          className="flex items-center gap-1 bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600 transition-colors"\n                        >\n                          <Check className="w-3 h-3" />\n                          Approve\n                        </button>\n                        <button\n                          onClick={() => handleActionApproval(action, false)}\n                          className="flex items-center gap-1 bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 transition-colors"\n                        >\n                          <X className="w-3 h-3" />\n                          Deny\n                        </button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          </div>\n        ))}\n\n        {/* Typing indicator */}\n        {isTyping && (\n          <div className="flex justify-start">\n            <div className="bg-gray-100 rounded-lg px-3 py-2">\n              <div className="flex items-center gap-2">\n                <div className="flex gap-1">\n                  <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>\n                  <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: \'0.1s\' }}></div>\n                  <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: \'0.2s\' }}></div>\n                </div>\n                <span className="text-sm text-gray-600">Jean is thinking...</span>\n              </div>\n            </div>\n          </div>\n        )}\n\n        <div ref={messagesEndRef} />\n      </div>\n\n      {/* Pending Actions Bar */}\n      {pendingActions.length > 0 && (\n        <div className="border-t border-gray-200 bg-yellow-50 p-2">\n          <div className="flex items-center gap-2 text-sm text-yellow-800">\n            <AlertCircle className="w-4 h-4" />\n            <span>{pendingActions.length} action{pendingActions.length !== 1 ? \'s\' : \'\'} pending approval</span>\n          </div>\n        </div>\n      )}\n\n      {/* Input Area */}\n      <div className="border-t border-gray-200 p-4">\n        <div className="flex gap-2">\n          <div className="flex-1 relative">\n            <input\n              ref={inputRef}\n              type="text"\n              value={inputMessage}\n              onChange={(e) => setInputMessage(e.target.value)}\n              onKeyPress={handleKeyPress}\n              placeholder="Ask Jean anything..."\n              className="w-full px-3 py-2 pr-20 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"\n              disabled={isTyping}\n            />\n            \n            {/* Voice Controls */}\n            <div className="absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1">\n              <button\n                onClick={toggleListening}\n                className={`p-1 rounded transition-colors ${\n                  isListening \n                    ? \'bg-red-100 text-red-600\' \n                    : \'hover:bg-gray-100 text-gray-600\'\n                }`}\n                title={isListening ? \'Stop recording\' : \'Start voice input\'}\n              >\n                <Mic className="w-4 h-4" />\n              </button>\n              <button\n                className="p-1 hover:bg-gray-100 text-gray-600 rounded transition-colors"\n                title="Text-to-speech"\n              >\n                <Volume2 className="w-4 h-4" />\n              </button>\n            </div>\n          </div>\n          \n          <button\n            onClick={handleSendMessage}\n            disabled={!inputMessage.trim() || isTyping}\n            className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"\n          >\n            <Send className="w-4 h-4" />\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n</create-file>\n</function_calls>'}